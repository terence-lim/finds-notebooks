

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>LLM Text Summarization &#8212; Financial Data Science Python Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'summarization_llm';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="LLM Finetuning" href="finetune_llm.html" />
    <link rel="prev" title="LLM Prompting" href="sentiment_llm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
  
    <p class="title logo__title">Financial Data Science Python Notebooks</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    FINANCIAL DATA SCIENCE
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="stock_prices.html">Stock Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="jegadeesh_titman.html">Jegadeesh-Titman Rolling Portfolios</a></li>
<li class="toctree-l1"><a class="reference internal" href="fama_french.html">Fama-French Portfolio Sorts</a></li>
<li class="toctree-l1"><a class="reference internal" href="fama_macbeth.html">Fama-Macbeth Cross-sectional Regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="weekly_reversal.html">Contrarian Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="quant_factors.html">Quant Factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="event_study.html">Event Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="economic_releases.html">Economic Data Revisions</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression_diagnostics.html">Linear Regression Diagonostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="econometric_forecast.html">Econometric Forecasts</a></li>
<li class="toctree-l1"><a class="reference internal" href="approximate_factors.html">Approximate Factor Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="economic_states.html">State Space Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="term_structure.html">Term Structure of Interest Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="bond_returns.html">Bond Returns and Risks</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditional_volatility.html">Conditional Volatility and VaR</a></li>
<li class="toctree-l1"><a class="reference internal" href="covariance_matrix.html">Covariance Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="options_pricing.html">Options Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="market_microstructure.html">Market Microstructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="event_risk.html">Event Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="customer_ego.html">Principal Customers Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="industry_community.html">Community Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="bea_centrality.html">Graph Centrality</a></li>
<li class="toctree-l1"><a class="reference internal" href="link_prediction.html">Link Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatial_regression.html">Spatial Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="fomc_topics.html">FOMC Topic Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="management_sentiment.html">Management Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="business_description.html">Business Text Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification_models.html">Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression_models.html">Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep_classifier.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="recurrent_net.html">Recurrent Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="convolutional_net.html">Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="reinforcement_learning.html">Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="fomc_language.html">FedSpeak Language Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="sentiment_llm.html">LLM Prompting</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">LLM Text Summarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="finetune_llm.html">LLM Finetuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag_agent.html">RAG, Chatbots and Agents</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/terence-lim/data-science-notebooks.git" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/terence-lim/data-science-notebooks.git/issues/new?title=Issue%20on%20page%20%2Fsummarization_llm.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/summarization_llm.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>LLM Text Summarization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#huggingface-apis">HuggingFace APIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-modules">Transformers modules</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantization">Quantization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature">Temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#azure-ai-api">Azure AI API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openai-api">OpenAI API</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#text-summarization">Text summarization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">Evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#role-prompting">Role prompting</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="llm-text-summarization">
<h1>LLM Text Summarization<a class="headerlink" href="#llm-text-summarization" title="Permalink to this heading">#</a></h1>
<p>Concepts:</p>
<ul class="simple">
<li><p>HuggingFace and Azure OpenAI APIs</p></li>
<li><p>Text summarization of 10-K Disclosures About Market Risk</p></li>
<li><p>Role prompting</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span><span class="p">,</span> <span class="n">AutoModelForCausalLM</span><span class="p">,</span> <span class="n">BitsAndBytesConfig</span>
<span class="kn">from</span> <span class="nn">transformers.utils</span> <span class="kn">import</span> <span class="n">logging</span>
<span class="kn">from</span> <span class="nn">openai</span> <span class="kn">import</span> <span class="n">AzureOpenAI</span>
<span class="kn">from</span> <span class="nn">rouge_score</span> <span class="kn">import</span> <span class="n">rouge_scorer</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">finds.database</span> <span class="kn">import</span> <span class="n">SQL</span><span class="p">,</span> <span class="n">RedisDB</span>
<span class="kn">from</span> <span class="nn">finds.unstructured</span> <span class="kn">import</span> <span class="n">Edgar</span>
<span class="kn">from</span> <span class="nn">finds.structured</span> <span class="kn">import</span> <span class="n">BusDay</span><span class="p">,</span> <span class="n">CRSP</span><span class="p">,</span> <span class="n">PSTAT</span>
<span class="kn">from</span> <span class="nn">finds.readers</span> <span class="kn">import</span> <span class="n">Sectoring</span>
<span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">paths</span><span class="p">,</span> <span class="n">credentials</span>
<span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity_error</span><span class="p">()</span> <span class="c1"># logging.set_verbosity_info() #logging.set_verbosity_warning()</span>
<span class="n">VERBOSE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">SAVED</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/terence/env3.11/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="n">SQL</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">[</span><span class="s1">&#39;sql&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">SQL</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">bd</span> <span class="o">=</span> <span class="n">BusDay</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
<span class="n">rdb</span> <span class="o">=</span> <span class="n">RedisDB</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">[</span><span class="s1">&#39;redis&#39;</span><span class="p">])</span>
<span class="n">crsp</span> <span class="o">=</span> <span class="n">CRSP</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">bd</span><span class="p">,</span> <span class="n">rdb</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">pstat</span> <span class="o">=</span> <span class="n">PSTAT</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">bd</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">ed</span> <span class="o">=</span> <span class="n">Edgar</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;10X&#39;</span><span class="p">],</span> <span class="n">zipped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Last FamaFrench Date 2024-04-30 00:00:00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve universe of stocks</span>
<span class="n">univ</span> <span class="o">=</span> <span class="n">crsp</span><span class="o">.</span><span class="n">get_universe</span><span class="p">(</span><span class="n">bd</span><span class="o">.</span><span class="n">endmo</span><span class="p">(</span><span class="mi">20231231</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lookup company names</span>
<span class="n">comnam</span> <span class="o">=</span> <span class="n">crsp</span><span class="o">.</span><span class="n">build_lookup</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;permno&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;comnam&#39;</span><span class="p">,</span> <span class="n">fillna</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">univ</span><span class="p">[</span><span class="s1">&#39;comnam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comnam</span><span class="p">(</span><span class="n">univ</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lookup sic codes from Compustat, and map to FF 10-sector code</span>
<span class="n">sic</span> <span class="o">=</span> <span class="n">pstat</span><span class="o">.</span><span class="n">build_lookup</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;lpermno&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;sic&#39;</span><span class="p">,</span> <span class="n">fillna</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">industry</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">sic</span><span class="p">[</span><span class="n">univ</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">univ</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">industry</span> <span class="o">=</span> <span class="n">industry</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">industry</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">univ</span><span class="p">[</span><span class="s1">&#39;siccd&#39;</span><span class="p">])</span>
<span class="n">sectors</span> <span class="o">=</span> <span class="n">Sectoring</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;codes10&#39;</span><span class="p">,</span> <span class="n">fillna</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>   <span class="c1"># supplement from crosswalk</span>
<span class="n">univ</span><span class="p">[</span><span class="s1">&#39;sector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sectors</span><span class="p">[</span><span class="n">industry</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Load Disclosure about Market Risk text from 10-K’s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve from 10K&#39;s in 1Q 2024</span>
<span class="n">item</span><span class="p">,</span> <span class="n">form</span> <span class="o">=</span> <span class="s1">&#39;qqr10K&#39;</span><span class="p">,</span> <span class="s1">&#39;10-K&#39;</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">ed</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">))</span>
<span class="n">found</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">rows</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">20240101</span><span class="p">,</span> <span class="mi">20240331</span><span class="p">)]</span>\
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;permno&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;permno&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Keep largest decile of stocks</span>
<span class="n">found</span> <span class="o">=</span> <span class="n">found</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">found</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">univ</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">univ</span><span class="p">[</span><span class="s1">&#39;decile&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Keep minimum length</span>
<span class="n">docs</span> <span class="o">=</span> <span class="p">{</span><span class="n">permno</span><span class="p">:</span> <span class="n">ed</span><span class="p">[</span><span class="n">found</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;pathname&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">permno</span> <span class="ow">in</span> <span class="n">found</span><span class="o">.</span><span class="n">index</span><span class="p">}</span>
<span class="n">permnos</span> <span class="o">=</span> <span class="p">[</span><span class="n">permno</span> <span class="k">for</span> <span class="n">permno</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">found</span> <span class="o">=</span> <span class="n">found</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Series</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;item&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">permnos</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="huggingface-apis">
<h2>HuggingFace APIs<a class="headerlink" href="#huggingface-apis" title="Permalink to this heading">#</a></h2>
<p>Command line interface</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">huggingface_hub[&quot;cli&quot;]</span></code></p>
<ul>
<li><p>To empty cache (in ~/.cache/huggingface/)</p>
<p><code class="docutils literal notranslate"><span class="pre">huggingface-cli</span> <span class="pre">delete-cache</span></code></p>
</li>
</ul>
<section id="transformers-modules">
<h3>Transformers modules<a class="headerlink" href="#transformers-modules" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>AutoTokenizers</p></li>
<li><p>AutoModels</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">generate</span></code> method:</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_id</span> <span class="o">=</span> <span class="s2">&quot;meta-llama/Meta-Llama-3-8B-Instruct&quot;</span>
<span class="n">save_name</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s1">&#39;scratch&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;Llama-3-8B-Instruct&quot;</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="n">save_name</span> <span class="k">if</span> <span class="n">SAVED</span> <span class="k">else</span> <span class="n">model_id</span>   <span class="c1"># load from folder if saved locally</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="quantization">
<h3>Quantization<a class="headerlink" href="#quantization" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://medium.com/&#64;manuelescobar-dev/implementing-and-running-llama-3-with-hugging-faces-transformers-library-40e9754d8c80">https://medium.com/&#64;manuelescobar-dev/implementing-and-running-llama-3-with-hugging-faces-transformers-library-40e9754d8c80</a></p>
<p>Quantization reduces the hardware requirements by loading the model weights with lower precision. Instead of loading them in 16 bits (float16), they are loaded in 4 bits, significantly reducing memory usage from ~20GB to ~8GB.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compute_dtype</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">torch</span><span class="p">,</span> <span class="s2">&quot;float16&quot;</span><span class="p">)</span>
<span class="n">bnb_config</span> <span class="o">=</span> <span class="n">BitsAndBytesConfig</span><span class="p">(</span>
    <span class="n">load_in_4bit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">bnb_4bit_use_double_quant</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">bnb_4bit_quant_type</span><span class="o">=</span><span class="s2">&quot;nf4&quot;</span><span class="p">,</span>
    <span class="n">bnb_4bit_compute_dtype</span><span class="o">=</span><span class="n">compute_dtype</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">bnb_config</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BitsAndBytesConfig {
  &quot;_load_in_4bit&quot;: true,
  &quot;_load_in_8bit&quot;: false,
  &quot;bnb_4bit_compute_dtype&quot;: &quot;float16&quot;,
  &quot;bnb_4bit_quant_storage&quot;: &quot;uint8&quot;,
  &quot;bnb_4bit_quant_type&quot;: &quot;nf4&quot;,
  &quot;bnb_4bit_use_double_quant&quot;: false,
  &quot;llm_int8_enable_fp32_cpu_offload&quot;: false,
  &quot;llm_int8_has_fp16_weight&quot;: false,
  &quot;llm_int8_skip_modules&quot;: null,
  &quot;llm_int8_threshold&quot;: 6.0,
  &quot;load_in_4bit&quot;: true,
  &quot;load_in_8bit&quot;: false,
  &quot;quant_method&quot;: &quot;bitsandbytes&quot;
}
</pre></div>
</div>
</div>
</div>
<p>Load model and tokenizer from Huggingface</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_id</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
    <span class="n">model_name</span><span class="p">,</span>
    <span class="n">quantization_config</span><span class="o">=</span><span class="n">bnb_config</span><span class="p">,</span>
    <span class="c1">#torch_dtype=torch.bfloat16,</span>
    <span class="n">device_map</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>  <span class="c1"># &quot;auto&quot;,  &#39;cuda&#39;</span>
<span class="p">)</span>
<span class="n">model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading checkpoint shards: 100%|██████████| 4/4 [00:08&lt;00:00,  2.01s/it]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(128256, 4096)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear4bit(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear4bit(in_features=4096, out_features=1024, bias=False)
          (v_proj): Linear4bit(in_features=4096, out_features=1024, bias=False)
          (o_proj): Linear4bit(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear4bit(in_features=4096, out_features=14336, bias=False)
          (up_proj): Linear4bit(in_features=4096, out_features=14336, bias=False)
          (down_proj): Linear4bit(in_features=14336, out_features=4096, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=4096, out_features=128256, bias=False)
)
</pre></div>
</div>
</div>
</div>
<p>Show model’s context length</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Maximum context length</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max context length&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_position_embeddings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max context length 8192
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the model to local disk</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">SAVED</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">save_pretrained</span><span class="p">(</span><span class="n">save_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CUDA memory: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">memory_allocated</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CUDA memory: 6.06 GB
</pre></div>
</div>
</div>
</div>
</section>
<section id="temperature">
<h3>Temperature<a class="headerlink" href="#temperature" title="Permalink to this heading">#</a></h3>
<p>Temperature is a parameter used to control the randomness of the model’s output during text generation. Low Temperature (value close to 0) decreases randomness, leading to more focused and predictable outputs. High Temperature increases randomness: the model is more likely to choose less probable words, leading to more diverse and creative outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Template to prompt and generate response</span>
<span class="n">MAX_CHAR</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="k">def</span> <span class="nf">generate_response</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">max_char</span><span class="o">=</span><span class="n">MAX_CHAR</span><span class="p">,</span>
                      <span class="n">role</span><span class="o">=</span><span class="s2">&quot;You are a helpful AI assistant&quot;</span><span class="p">,</span>
                      <span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;Write a concise summary of the text.&quot;</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Text in triple quotes: &#39;&#39;&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">text</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">)[:</span><span class="n">max_char</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&#39;&#39;</span>

<span class="s2">Summary:&quot;&quot;&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">role</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">},</span>
    <span class="p">]</span>

    <span class="n">input_ids</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">apply_chat_template</span><span class="p">(</span>
        <span class="n">messages</span><span class="p">,</span>
        <span class="n">add_generation_prompt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">VERBOSE</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tokens:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">input_ids</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span>
              <span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_position_embeddings</span><span class="p">)</span>

    <span class="n">terminators</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">convert_tokens_to_ids</span><span class="p">(</span><span class="s2">&quot;&lt;|eot_id|&gt;&quot;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">input_ids</span><span class="p">,</span>
        <span class="n">max_new_tokens</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>  
        <span class="n">eos_token_id</span><span class="o">=</span><span class="n">terminators</span><span class="p">,</span>
        <span class="c1">#do_sample=True,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="c1">#0.6,</span>
        <span class="c1">#top_p=0.9,</span>
    <span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">input_ids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:]</span>
    <span class="k">return</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="azure-ai-api">
<h2>Azure AI API<a class="headerlink" href="#azure-ai-api" title="Permalink to this heading">#</a></h2>
<p>Azure, Microsoft’s cloud-based platform for AI and other subscription services, provides API’s and endpoints for OpenAI’s models.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://oai.azure.com/portal">https://oai.azure.com/portal</a></p></li>
<li><p><a class="reference external" href="https://openai.com/api/">https://openai.com/api/</a></p></li>
</ul>
<section id="openai-api">
<h3>OpenAI API<a class="headerlink" href="#openai-api" title="Permalink to this heading">#</a></h3>
<p>Alternatively, GPT and other AI models, such as Whisper for automatic speech recognization (ASR), can be accessed directly from OpenAI:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://platform.openai.com/docs/overview">https://platform.openai.com/docs/overview</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create client object</span>
<span class="n">LLM_MODEL</span> <span class="o">=</span> <span class="s2">&quot;gpt-35-turbo-16k&quot;</span>   <span class="c1"># name of model to use</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">AzureOpenAI</span><span class="p">(</span><span class="n">api_version</span><span class="o">=</span><span class="s2">&quot;2024-02-01&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">credentials</span><span class="p">[</span><span class="s1">&#39;azure&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># template to prompt GPT and generate response</span>
<span class="k">def</span> <span class="nf">get_gpt_response</span><span class="p">(</span><span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">system_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                     <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">LLM_MODEL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creating message required by API: &quot;prompt&quot; will be the query sent to GPT&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">system_prompt</span><span class="p">},</span>
                    <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}]</span>
        <span class="n">completion</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>  <span class="c1"># must match the custom deployment name you chose</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">completion</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR!</span><span class="se">\n\n</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="text-summarization">
<h2>Text summarization<a class="headerlink" href="#text-summarization" title="Permalink to this heading">#</a></h2>
<p>Text summarization is the task of condensing a piece of text into a shorter version while retaining its key information and meaning. It aims to generate a concise summary that captures the main points of the original document or passage.</p>
<p>Sample one company from each industry, and generate summary of risk disclosure text with quantized Llama-3-8B model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample companies from each industry sector</span>
<span class="n">docs</span> <span class="o">=</span> <span class="n">univ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">found</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sector&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">permno</span> <span class="ow">in</span> <span class="n">docs</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=====&#39;</span><span class="p">,</span> <span class="n">univ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;comnam&#39;</span><span class="p">],</span> <span class="s1">&#39;=====&#39;</span><span class="p">)</span>
    <span class="n">summary</span><span class="p">[</span><span class="n">permno</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_response</span><span class="p">(</span><span class="n">found</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">summary</span><span class="p">[</span><span class="n">permno</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== BOOKING HOLDINGS INC =====
Here is a concise summary of the text:

The company is exposed to market risk due to changes in interest
rates, foreign currency exchange rates, and equity prices. To manage
this risk, the company uses internal policies and procedures, as well
as derivative financial instruments, such as foreign currency exchange
contracts. The company evaluates its exposure to market risk by
assessing near-term and long-term fluctuations in interest rates and
foreign currency exchange rates. The company also faces exposure to
movements in foreign currency exchange rates due to its businesses
outside the US, which are translated from local currencies into US
dollars. Additionally, the company is exposed to equity price risk due
to changes in the fair values of its investments in equity securities
of publicly-traded companies and private companies.

===== PIONEER NATURAL RESOURCES CO =====
Here is a concise summary of the text:

The company, Pioneer Natural Resources Company, discloses its market
risk exposure in its financial statements. The company&#39;s primary
market risk exposure is related to commodity price risk, which is
mitigated by maintaining financial flexibility and diversifying oil
and gas sales. The company also uses marketing derivatives to
diversify oil pricing to Gulf Coast and international markets.
Additionally, the company is exposed to share price risk when holders
of convertible notes exercise their conversion option, and interest
rate risk due to fixed-rate debt. The company&#39;s credit risk is
primarily associated with the collection of receivables from the sale
of oil and gas production and purchased commodities, and the risk of a
counterparty&#39;s failure to meet its obligations under derivative
contracts.

===== PAYPAL HOLDINGS INC =====
The text discusses the market risk, interest rate risk, foreign
currency exchange rate risk, and equity investment risk faced by the
company. Market risk refers to the potential for economic losses due
to adverse changes in market factors such as interest rates, foreign
currency exchange rates, and equity investment risk. The company has
established policies to mitigate these risks and monitors risk
exposures on an ongoing basis.

Interest rate risk is managed by maintaining a diversified portfolio
of cash, cash equivalents, and available-for-sale debt securities, and
by using interest rate swaps and other derivatives to hedge against
interest rate changes. The company also has foreign currency exchange
contracts to manage foreign currency exchange rate risk and to reduce
the impact of currency fluctuations on its consolidated cash flows and
results of operations.

Equity investment risk is managed by diversifying the portfolio of
strategic investments and by regularly reviewing the fair value of
these investments. The company also has a foreign currency exchange
exposure management program to identify material foreign currency
exposures and to manage these exposures through the execution of
foreign currency exchange contracts.

The company&#39;s risk management policies and procedures are designed to
identify, assess, and mitigate risks that could have a material impact
on its financial performance and position.

===== BOSTON SCIENTIFIC CORP =====
Boston Scientific Corporation, a medical device company, reports its
market risk exposure and risk management practices. The company&#39;s
earnings and cash flows are exposed to market risk from changes in
currency exchange rates and interest rates. To manage this risk, the
company uses derivative financial instruments, such as currency and
interest rate swaps, to hedge its exposure. The company&#39;s currency
risk consists primarily of foreign currency-denominated firm
commitments, forecasted foreign currency-denominated intercompany and
third-party transactions, and net investments in certain subsidiaries.
The company&#39;s interest rate risk relates primarily to US dollar and
euro-denominated borrowings partially offset by US dollar cash
investments. The company&#39;s risk management program is designed to
minimize the impact of market risk on its earnings and cash flows.

===== R T X CORP =====
Here is a concise summary of the text:

The company is exposed to market risk due to fluctuations in foreign
currency exchange rates and interest rates. To manage this risk, they
use foreign currency forward contracts to hedge foreign-denominated
payments and receipts. The company also hedges foreign currency
exposures associated with committed foreign currency purchases and
sales. The aggregate notional amount of outstanding foreign currency
hedges was $15.8 billion and $11.2 billion at December 31, 2023 and
2022, respectively. The company&#39;s sales are typically denominated in
US dollars, but they also transact business in various foreign
currencies, exposing them to changes in foreign currency exchange
rates. To minimize this exposure, they hedge a certain portion of
sales to secure the rates at which US dollars will be converted. The
company also has financial instruments subject to interest rate risk,
primarily fixed-rate debt obligations, but they believe their exposure
to interest rate risk is not material.

===== MONSTER BEVERAGE CORP NEW =====
Here is a concise summary of the text:

The company is exposed to various market risks, including fluctuations
in commodity and energy prices, foreign currency exchange rates, and
limitations in raw material availability. To manage foreign exchange
risk, the company enters into forward currency exchange contracts with
financial institutions, but does not designate them as hedge
transactions. The company&#39;s investments are also subject to various
risks, including credit, liquidity, market, and interest rate risks.

===== HILTON WORLDWIDE HOLDINGS INC =====
Here is a concise summary of the text:

The company is exposed to market risk primarily from changes in
interest rates and foreign currency exchange rates. To manage this
risk, they use derivative financial instruments, such as interest rate
swaps and forward contracts, to hedge against a portion of the risks.
The company&#39;s exposure to interest rate risk is primarily related to
variable-rate indebtedness, while foreign currency exchange rate risk
is associated with international revenues and expenses. The company
uses hedging instruments to reduce volatility in their results of
operations and cash flows.

===== TARGET CORP =====
The text is a section from a company&#39;s Form 10-K filing with the US
Securities and Exchange Commission. It provides a summary of the
company&#39;s market risk exposure, including:

* Interest rate risk: The company&#39;s floating rate debt obligations and
short-term investments expose it to changes in interest rates. A 1%
increase in interest rates would increase earnings before income taxes
by $5 million.
* Pension risk: The company&#39;s qualified defined benefit pension plan
is exposed to changes in interest rates, which could increase annual
expense by $36 million if interest rates decrease.
* General liability and workers&#39; compensation risk: The company&#39;s
liabilities for general liability and workers&#39; compensation are
recorded at net present value and fluctuate with changes in interest
rates.
* Nonqualified deferred compensation risk: The company&#39;s nonqualified,
unfunded deferred compensation plans expose it to market returns on
accumulated team member balances.

The company maintains insurance coverage to limit its exposure to
certain events, including network security matters. It also maintains
a funded qualified defined benefit pension plan and nonqualified and
international pension plans that are generally unfunded.

===== A T &amp; T INC =====
Here is a concise summary of the text:

The report discusses the financial statements of AT&amp;T Inc. (AT&amp;T) for
the year ended December 31, 2023. The company is exposed to market
risks, primarily from changes in interest rates and foreign currency
exchange rates. To manage these risks, AT&amp;T employs derivatives, such
as interest rate swaps and foreign currency exchange contracts.

The report also discusses the company&#39;s internal control over
financial reporting, which is designed to provide reasonable assurance
regarding the reliability of financial reporting and the preparation
of financial statements. The company&#39;s management is responsible for
maintaining effective internal control over financial reporting, and
the independent registered public accounting firm, Ernst &amp; Young LLP,
has issued an unqualified opinion on the effectiveness of the
company&#39;s internal control over financial reporting.

The report also highlights the critical audit matters, which are
matters arising from the current period audit of the financial
statements that were communicated or required to be communicated to
the audit committee and that relate to accounts or disclosures that
are material to the financial statements. The critical audit matters
discussed in the report include the discount rates used in determining
pension and postretirement benefit obligations and the evaluation of
goodwill for impairment.

===== WASTE MANAGEMENT INC DEL =====
The text discusses the market risk exposure of a company, specifically
in the areas of interest rates, commodity prices, and Canadian
currency rates. The company has exposure to changes in interest rates
through its debt obligations, including short-term borrowings and tax-
exempt bonds. The company also has exposure to commodity price risks
through its operating agreements and investments in renewable energy
production. The company has invested in facilities to capture methane
from landfills and convert it into renewable natural gas, which is
used to produce transportation fuels. The company is also exposed to
currency rate risks due to its operations in Canada and India.
</pre></div>
</div>
</div>
</div>
<section id="evaluation">
<h3>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this heading">#</a></h3>
<p><strong>ROUGE</strong></p>
<p>Recall-Oriented Understudy for Gisting Evaluation (ROUGE) is a set of metrics used to evaluate the quality of summaries by comparing them to reference summaries or human-generated summaries.</p>
<ul class="simple">
<li><p>ROUGE-N measures the overlap of n-grams (contiguous sequences of n words) between the system-generated and the reference summaries</p></li>
<li><p>ROUGE-L measures the longest common subsequence (LCS).</p></li>
</ul>
<p>Recall, precision and F1-measure versions of these metrics can be computed.</p>
<p><strong>BLEU</strong></p>
<p>Bilingual Evaluation Understudy (BLEU) is a metric originally designed for evaluating machine translation, but it is also adapted for text summarization evaluation.</p>
<ul class="simple">
<li><p>N-gram Precision measures the overlap of n-grams (typically up to 4-grams) between the system-generated summary and the reference summary.</p></li>
<li><p>Brevity Penalty penalizes overly short summaries that do not capture enough information from the reference summaries.</p></li>
<li><p>Cumulative BLEU calculates the geometric mean of BLEU scores for 1-gram to n-gram, rewarding systems that produce more accurate translations across longer phrases.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To compute rouge-1 and rouge-2 scores</span>
<span class="n">rouge_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rouge1&#39;</span><span class="p">,</span> <span class="s1">&#39;rouge2&#39;</span><span class="p">]</span>
<span class="n">scorer</span> <span class="o">=</span> <span class="n">rouge_scorer</span><span class="o">.</span><span class="n">RougeScorer</span><span class="p">(</span><span class="n">rouge_types</span><span class="p">,</span> <span class="n">use_stemmer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">{</span><span class="n">rouge_type</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">rouge_type</span> <span class="ow">in</span> <span class="n">rouge_types</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Generete reference summaries from GPT</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reference</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">permno</span> <span class="ow">in</span> <span class="n">docs</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=====&#39;</span><span class="p">,</span> <span class="n">univ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;comnam&#39;</span><span class="p">],</span> <span class="s1">&#39;=====&#39;</span><span class="p">)</span>
    <span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;You are an AI assistant.&quot;</span>
    <span class="n">prompt_template</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&quot;Write a concise summary of the text.</span>

<span class="s2">Text in triple quotes: &#39;&#39;&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">found</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="p">)[:</span><span class="n">MAX_CHAR</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&#39;&#39;</span>

<span class="s2">Summary:&quot;&quot;&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>    
    <span class="n">reference</span><span class="p">[</span><span class="n">permno</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_gpt_response</span><span class="p">(</span><span class="n">prompt_template</span><span class="p">,</span> <span class="n">system_prompt</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">reference</span><span class="p">[</span><span class="n">permno</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">scorer</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">reference</span><span class="p">[</span><span class="n">permno</span><span class="p">],</span> <span class="n">prediction</span><span class="o">=</span><span class="n">summary</span><span class="p">[</span><span class="n">permno</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">rouge_type</span> <span class="ow">in</span> <span class="n">rouge_types</span><span class="p">:</span>
        <span class="n">scores</span><span class="p">[</span><span class="n">rouge_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Series</span><span class="p">(</span><span class="n">score</span><span class="p">[</span><span class="n">rouge_type</span><span class="p">]</span><span class="o">.</span><span class="n">_asdict</span><span class="p">(),</span>
                                         <span class="n">name</span><span class="o">=</span><span class="n">univ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;comnam&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== BOOKING HOLDINGS INC =====
The text discusses the market risks that a company is exposed to,
including changes in interest rates, foreign currency exchange rates,
and equity prices. The company manages these risks through established
policies and procedures, as well as the use of derivative financial
instruments. The objective is to mitigate potential adverse
fluctuations in income statement, cash flow, and fair value. The
company evaluates its exposure by assessing near-term and long-term
fluctuations, utilizing market indicators and projections. The company
does not engage in speculative trading or leveraged derivatives. The
text also mentions the impact of interest rate changes on the fair
value of debt and the sensitivity of convertible senior notes to
equity market price volatility. Additionally, the company faces
exposure to foreign currency exchange rates due to the translation of
financial results from local currencies to US dollars. The impact of
currency exchange rates on gross bookings and revenues is discussed.
The company uses foreign currency exchange derivatives to hedge its
exposure. Lastly, the text mentions the equity price risk associated
with investments in publicly-traded and private companies, with
potential losses in fair value.

===== PIONEER NATURAL RESOURCES CO =====
The text provides quantitative and qualitative disclosures about
market risk for a company. The company faces risks related to changes
in commodity prices, changes in its share price, interest rate
movements, and credit risks. The company mitigates commodity price
risk through financial flexibility and diversification of sales. It
also enters into pipeline capacity commitments and purchase
transactions to diversify its sales. The company uses marketing
derivatives to diversify its oil pricing. It has long-term marketing
contracts that are accounted for as derivative instruments.
Fluctuations in the fair value of marketing derivatives could occur
based on changes in price differentials. The company is also exposed
to share price risk and interest rate risk. It manages credit risk
through credit risk policies and procedures.

===== PAYPAL HOLDINGS INC =====
The text discusses the market risk faced by a company due to adverse
changes in market factors such as interest rates, foreign currency
exchange rates, and equity investment risk. The company has policies
in place to mitigate these risks and monitors its risk exposures. It
is exposed to interest rate risk in its investment portfolio and
customer balances. Changes in interest rates can affect the interest
income earned and the fair value of securities. The company also faces
foreign currency exchange rate risk due to its international
operations and uses hedging contracts to manage this risk. Adverse
changes in exchange rates can impact the company&#39;s cash flows and
results of operations. Additionally, the company has strategic
investments that are subject to market-related risks, and changes in
the value of these investments can impact the company&#39;s net income.

===== BOSTON SCIENTIFIC CORP =====
The text discusses the market risks faced by a medical device company
due to changes in currency exchange rates and interest rates. The
company manages these risks through a risk management program that
includes the use of derivative financial instruments. The company
primarily uses nonderivative and derivative instruments to manage its
exposure to currency exchange rate fluctuations. It also uses interest
rate derivative instruments to manage its exposure to changes in
interest rates. The company has a diversified group of major financial
institutions as counterparties for its derivative instruments. The
text also includes an audit opinion on the company&#39;s financial
statements, highlighting a critical audit matter related to the
accounting for business combinations. The auditor evaluated the
company&#39;s controls and tested the fair value estimates of intangible
assets and contingent consideration liabilities related to the
acquisitions.

===== R T X CORP =====
The text discusses the market risk exposures of a company, primarily
related to fluctuations in foreign currency exchange rates and
interest rates. The company uses sensitivity analysis to quantify its
market risk exposure and employs foreign currency forward contracts to
hedge price risk associated with foreign denominated payments and
receipts. The company actively manages foreign currency exposures and
hedges significant exposures with foreign currency derivatives. The
aggregate notional amount of outstanding foreign currency hedges is
provided. The company also faces foreign currency exchange impact and
risk to operational results due to costs incurred in local currencies
and transacting business in various foreign currencies. To minimize
exposure, the company hedges a portion of sales and forecasts of
costs. Hedging gains and losses are partially offset by foreign
currency translation impacts. The company also has fixed-rate and
variable-rate debt obligations subject to interest rate risk, but the
exposure is considered not material. The company may consider using
interest rate swaps in the future to hedge floating rates.

===== MONSTER BEVERAGE CORP NEW =====
The text discusses the market risks faced by a company in its normal
business operations. The main market risks include fluctuations in
commodity and input prices, energy and fuel prices, and limitations in
the availability of raw materials and packaging materials. The company
does not use hedging agreements or alternative instruments to manage
these risks. Additionally, the company is exposed to risks from
changes in foreign currency exchange rates due to its international
business expansion strategy. The company has entered into forward
currency exchange contracts to manage a portion of the foreign
exchange risk exposure. However, these contracts are not designated as
hedge transactions. The gains and losses on these contracts are
recognized in the consolidated statements of income. The company does
not consider the potential loss resulting from a hypothetical adverse
change in foreign currency exchange rates to be significant. The
company also discloses its cash and investment holdings, which are
subject to general credit, liquidity, market, and interest rate risks.

===== HILTON WORLDWIDE HOLDINGS INC =====
The company is exposed to market risk primarily from changes in
interest rates and foreign currency exchange rates. They use
derivative financial instruments to hedge against these risks and
reduce volatility in their results of operations and cash flows. They
are exposed to interest rate risk on their variable-rate indebtedness,
but use an interest rate swap to maintain an appropriate level of
exposure. They also have exposure to foreign currency exchange rate
risk due to conducting business in various currencies. They use
forward contracts as cash flow hedges and not designated as hedging
instruments to offset this risk. The fair value and earnings effect of
these contracts are not considered material to their financial
statements.

===== TARGET CORP =====
The text provides various disclosures related to market risk, income
taxes, pension accounting, legal and other contingencies, new
accounting pronouncements, and forward-looking statements. It also
includes quantitative and qualitative disclosures about market risk,
specifically related to interest rate changes, debt obligations,
short-term investments, liabilities, and pension plan exposures. The
text concludes with an index to the financial statements.

===== A T &amp; T INC =====
The text discusses AT&amp;T Inc.&#39;s exposure to market risks, primarily
from changes in interest rates and foreign currency exchange rates.
The company manages these risks through the use of derivatives, such
as interest rate swaps and foreign currency exchange contracts. They
do not use derivatives for trading or speculative purposes. The text
also mentions the significant assumption of the weighted-average
discount rate used in estimating postretirement benefit obligations.
Lower discount rates result in higher obligations, while future
increases in rates could lead to lower obligations. The text further
highlights the interest rate risk associated with the company&#39;s
financial instruments, such as fixed-rate notes and debentures. AT&amp;T
manages interest expense by controlling the mix of fixed- and
floating-rate debt through various instruments. The company also uses
cross-currency swaps to hedge foreign currency exchange risk. The text
concludes with the report of management and the independent registered
public accounting firm, which express opinions on the company&#39;s
financial statements and internal control over financial reporting.

===== WASTE MANAGEMENT INC DEL =====
The text discusses the market risks that a company is exposed to,
including changes in interest rates, commodity prices, and currency
rates. The company uses derivatives to manage these risks but had no
derivatives outstanding as of December 31, 2023. The company&#39;s
exposure to interest rate changes primarily relates to its financing
activities, and a 100-basis point increase in interest rates would
increase its 2024 interest expense by $18 million. The company is also
exposed to commodity price risks, particularly in relation to diesel
fuel, electricity, and recycled materials. The decline in commodity
prices has put pressure on the company&#39;s margins. Additionally, the
company is exposed to currency rate risks due to its operations in
Canada and support functions in India, but the impact of foreign
currency has not materially affected its results of operations.
</pre></div>
</div>
</div>
</div>
<p>Compare rouge-1 metric</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rouge_type</span> <span class="o">=</span> <span class="n">rouge_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">rouge_type</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rouge_type</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> metric:&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;  average&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ROUGE1 metric:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>fmeasure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BOOKING HOLDINGS INC</th>
      <td>0.825758</td>
      <td>0.586022</td>
      <td>0.685535</td>
    </tr>
    <tr>
      <th>PIONEER NATURAL RESOURCES CO</th>
      <td>0.511450</td>
      <td>0.544715</td>
      <td>0.527559</td>
    </tr>
    <tr>
      <th>PAYPAL HOLDINGS INC</th>
      <td>0.500000</td>
      <td>0.764286</td>
      <td>0.604520</td>
    </tr>
    <tr>
      <th>BOSTON SCIENTIFIC CORP</th>
      <td>0.488372</td>
      <td>0.456522</td>
      <td>0.471910</td>
    </tr>
    <tr>
      <th>R T X CORP</th>
      <td>0.675000</td>
      <td>0.646707</td>
      <td>0.660550</td>
    </tr>
    <tr>
      <th>MONSTER BEVERAGE CORP NEW</th>
      <td>0.826667</td>
      <td>0.382716</td>
      <td>0.523207</td>
    </tr>
    <tr>
      <th>HILTON WORLDWIDE HOLDINGS INC</th>
      <td>0.726316</td>
      <td>0.594828</td>
      <td>0.654028</td>
    </tr>
    <tr>
      <th>TARGET CORP</th>
      <td>0.190217</td>
      <td>0.583333</td>
      <td>0.286885</td>
    </tr>
    <tr>
      <th>A T &amp; T INC</th>
      <td>0.473684</td>
      <td>0.578947</td>
      <td>0.521053</td>
    </tr>
    <tr>
      <th>WASTE MANAGEMENT INC DEL</th>
      <td>0.638095</td>
      <td>0.485507</td>
      <td>0.551440</td>
    </tr>
    <tr>
      <th>average</th>
      <td>0.585556</td>
      <td>0.562358</td>
      <td>0.548669</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Compare rouge-2 metric</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rouge_type</span> <span class="o">=</span> <span class="n">rouge_types</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">rouge_type</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rouge_type</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> metric:&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;  average&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ROUGE2 metric:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>fmeasure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BOOKING HOLDINGS INC</th>
      <td>0.496183</td>
      <td>0.351351</td>
      <td>0.411392</td>
    </tr>
    <tr>
      <th>PIONEER NATURAL RESOURCES CO</th>
      <td>0.215385</td>
      <td>0.229508</td>
      <td>0.222222</td>
    </tr>
    <tr>
      <th>PAYPAL HOLDINGS INC</th>
      <td>0.291080</td>
      <td>0.446043</td>
      <td>0.352273</td>
    </tr>
    <tr>
      <th>BOSTON SCIENTIFIC CORP</th>
      <td>0.203125</td>
      <td>0.189781</td>
      <td>0.196226</td>
    </tr>
    <tr>
      <th>R T X CORP</th>
      <td>0.383648</td>
      <td>0.367470</td>
      <td>0.375385</td>
    </tr>
    <tr>
      <th>MONSTER BEVERAGE CORP NEW</th>
      <td>0.540541</td>
      <td>0.248447</td>
      <td>0.340426</td>
    </tr>
    <tr>
      <th>HILTON WORLDWIDE HOLDINGS INC</th>
      <td>0.521277</td>
      <td>0.426087</td>
      <td>0.468900</td>
    </tr>
    <tr>
      <th>TARGET CORP</th>
      <td>0.060109</td>
      <td>0.186441</td>
      <td>0.090909</td>
    </tr>
    <tr>
      <th>A T &amp; T INC</th>
      <td>0.269231</td>
      <td>0.329412</td>
      <td>0.296296</td>
    </tr>
    <tr>
      <th>WASTE MANAGEMENT INC DEL</th>
      <td>0.355769</td>
      <td>0.270073</td>
      <td>0.307054</td>
    </tr>
    <tr>
      <th>average</th>
      <td>0.333635</td>
      <td>0.304461</td>
      <td>0.306108</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="role-prompting">
<h2>Role prompting<a class="headerlink" href="#role-prompting" title="Permalink to this heading">#</a></h2>
<p>Creating prompts based on the role or perspective of the person can be a useful technique for generating more relevant and engaging responses from language models.</p>
<p>The <strong>system prompt</strong> is an initial set of instructions that serve as the starting point when starting a new chat session. This defines things for the model and helps to focus its capabilities.
The model will assume that role or person including their style.</p>
<p>For example, we can generate a more user-friendly summary to help explain the risk disclosures in 10-K’s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">role</span> <span class="o">=</span> <span class="s2">&quot;You are a helpful first-grade teacher.&quot;</span><span class="p">,</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;Write a simple summary of the text for a first-grader.&quot;</span>
<span class="n">simple</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">permno</span> <span class="ow">in</span> <span class="n">docs</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=====&#39;</span><span class="p">,</span> <span class="n">univ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;comnam&#39;</span><span class="p">],</span> <span class="s1">&#39;=====&#39;</span><span class="p">)</span>
    <span class="n">simple</span><span class="p">[</span><span class="n">permno</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_response</span><span class="p">(</span><span class="n">found</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">permno</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">],</span>
                                       <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">simple</span><span class="p">[</span><span class="n">permno</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== BOOKING HOLDINGS INC =====
Here&#39;s a summary of the text for a first-grader:

Imagine you have some money in a special account. Sometimes, the value
of that money can go up or down. This can happen because of things
like changes in interest rates, like when you borrow money from a
bank, or changes in the value of other countries&#39; money, like when you
buy something from a friend who lives in another country.

We have to be careful with our money, so we make plans to keep it
safe. We use special tools, like special contracts, to help keep our
money safe. We also look at what&#39;s happening in the world, like what&#39;s
happening with interest rates and other countries&#39; money, to make sure
we&#39;re making good choices.

Sometimes, we might have to make some changes to our plans, like if
the value of our money goes up or down. But we&#39;re always trying to
keep our money safe and make good choices.

===== PIONEER NATURAL RESOURCES CO =====
Here&#39;s a summary of the text for a first-grader:

The company that makes oil and gas is like a big store that sells
things. They have to worry about some risks, like if the price of oil
goes up or down. This can affect how much money they have to use for
important things like building new things or paying bills.

The company tries to be smart about this by making deals with other
companies to sell their oil and gas to them. This helps them get a
better price for their oil and gas. They also have to be careful about
who they sell to, so they don&#39;t get stuck with bad debts.

The company also has to worry about the price of their own shares,
like if someone buys or sells them. This can affect how much money
they have.

The company is like a big team that works together to make sure
they&#39;re safe and smart about their business.

===== PAYPAL HOLDINGS INC =====
Hi there! So, you know how sometimes we buy things like toys or candy,
and we have to pay for them? Well, grown-ups have to pay for things
too, like money they borrow from banks. And just like how we might get
a little worried if we can&#39;t find our favorite toy, grown-ups get
worried if they can&#39;t pay back the money they borrowed.

This is because there are things called &quot;risks&quot; that can happen, like
if the price of something goes up or down. It&#39;s like if you bought a
toy for $10, but then the price went up to $15. You would have to pay
more money to get the same toy!

Grown-ups have to worry about these risks so they can make sure they
have enough money to pay back what they borrowed. They do this by
using special tools, like contracts, to help them manage these risks.
It&#39;s like having a special insurance policy for your toys, so you can
feel safe and not worry about losing them.

So, that&#39;s what this big text is talking about! It&#39;s like a big report
card for grown-ups, showing how they&#39;re doing with managing these
risks and making sure they have enough money.

===== BOSTON SCIENTIFIC CORP =====
Hi there! So, you know how we use money to buy things we need and
want? Like toys and candy? Well, grown-ups use money to buy things
too, like buildings and machines. And just like how we have to be
careful with our money, grown-ups have to be careful with the money
they use to buy things too.

Sometimes, grown-ups use special kinds of money, called &quot;derivatives&quot;,
to help them make sure they have enough money to buy the things they
need. It&#39;s like having a special kind of insurance that helps them
feel safe and secure.

The company I&#39;m talking about, Boston Scientific, is a big company
that makes medical devices, like machines that help people feel
better. They use derivatives to help them make sure they have enough
money to buy the things they need to make those machines.

They also have to be careful with the money they use to buy things,
because sometimes the value of that money can go up and down. It&#39;s
like how the value of a toy can go up and down depending on how many
people want it. So, they have to be careful and make sure they&#39;re
making good choices with their money.

That&#39;s it!

===== R T X CORP =====
Here&#39;s a summary of the text for a first-grader:

Imagine you have some money in a special account, and you&#39;re worried
that the value of that money might change because of something called
&quot;market risk&quot;. This means that if the value of money changes, it could
affect how much money you have.

The company I work for has to deal with this kind of risk because we
do business with people in different countries. This means that we
have to worry about changes in the value of money between those
countries.

To help us deal with this risk, we use special tools called &quot;hedges&quot;.
These hedges are like insurance policies that help us keep the value
of our money stable, even if the value of money changes.

We also have to worry about something called &quot;interest rate risk&quot;.
This is when the interest rate on our loans or debts changes, and it
could affect how much money we have.

But don&#39;t worry, we have people who help us manage these risks and
make sure we have enough money to do our work.

===== MONSTER BEVERAGE CORP NEW =====
Here&#39;s a summary of the text for a first-grader:

Our company makes yummy drinks and foods, and we need to buy special
things like sugar, milk, and aluminum cans to make them. Sometimes,
the prices of these things go up and down, and that can affect how
much money we make. We try to be careful and not get too much money
from these price changes. We also buy things from other countries, and
the prices of those things can change too. We have special agreements
with banks to help us with these changes. We have a lot of money in
the bank, and we try to be smart about how we use it.

===== HILTON WORLDWIDE HOLDINGS INC =====
Here&#39;s a summary of the text for a first-grader:

Imagine you have some money in your piggy bank, and you&#39;re worried
that it might change value because of something called &quot;interest
rates&quot; or &quot;foreign currency exchange rates&quot;. These are like big waves
that can make your money go up or down.

The company I work for has to deal with these waves too. We have to be
careful so that our money doesn&#39;t get too big or too small. To do
this, we use special tools called &quot;derivatives&quot; that help us keep our
money safe.

For example, if we have some money that&#39;s tied to a special interest
rate, we might use a special contract to make sure our money doesn&#39;t
get too big or too small. It&#39;s like having a special insurance policy
to keep our money safe!

We also have to deal with foreign currencies, like when you go on a
trip and need to exchange your money for the local currency. We have
to be careful so that our money doesn&#39;t get too big or too small
because of these changes.

That&#39;s what this text is talking about!

===== TARGET CORP =====
Here is a summary of the text for a first-grader:

Our company is like a big team that works together. We have to make
sure we&#39;re safe and sound, so we have insurance to protect us from bad
things that might happen. We also have to pay taxes, like when you buy
something and have to give some money to the government. We have to
make sure we&#39;re being fair and honest with our money.

We also have to take care of our team members, like you and your
friends. We have special plans to help them when they get old or sick.
We have to make sure we&#39;re being kind and helping each other.

We also have to be careful with our money and make sure we&#39;re not
taking too many risks. We have to make smart choices so we can be safe
and happy.

===== A T &amp; T INC =====
Hi there! So, you know how sometimes we talk about money and how it&#39;s
used? Like, how much we have, how we spend it, and how we save it?
Well, this text is about a big company called AT&amp;T, and it&#39;s talking
about how they use their money.

They&#39;re saying that they have some risks, like changes in interest
rates and foreign currencies, that can affect how much money they
have. But they&#39;re also saying that they have ways to manage those
risks, like using special contracts to protect themselves.

They&#39;re also talking about how they use something called &quot;discount
rates&quot; to figure out how much money they owe to people who are
retired. It&#39;s kind of like a big math problem, and they have to make
some guesses about what will happen in the future.

The company is also saying that they have a special team that checks
their books to make sure everything is correct. It&#39;s like a big audit,
and they&#39;re making sure that everything is fair and honest.

So, that&#39;s what this text is about! It&#39;s like a big report card for
AT&amp;T, and it&#39;s showing how they&#39;re doing with their money.

===== WASTE MANAGEMENT INC DEL =====
Here&#39;s a summary of the text for a first-grader:

A big company that helps keep our planet clean has to deal with some
risks. Just like how you might worry about losing your favorite toy,
this company worries about things like interest rates, prices of
things like diesel fuel and electricity, and how much money they get
from other countries.

They use special tools to try to make sure they&#39;re not too worried
about these things. They also try to make sure they&#39;re doing good
things for the planet, like making special gas for cars and trucks.

The company is like a big team working together to make sure they&#39;re
safe and doing good things. They&#39;re like a superhero, but instead of
having superpowers, they have smart people working together to make
the world a better place!
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="sentiment_llm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">LLM Prompting</p>
      </div>
    </a>
    <a class="right-next"
       href="finetune_llm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">LLM Finetuning</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#huggingface-apis">HuggingFace APIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformers-modules">Transformers modules</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantization">Quantization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature">Temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#azure-ai-api">Azure AI API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openai-api">OpenAI API</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#text-summarization">Text summarization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">Evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#role-prompting">Role prompting</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Terence Lim
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>